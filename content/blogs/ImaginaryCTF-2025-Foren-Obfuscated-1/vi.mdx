---
title: "Forensic / Obfuscated-1 - Imaginary CTF 2025"
excerpt: "A writeup on the Forensic / Obfuscated-1 challenge from Imaginary CTF 2025"
category:
  - "Writeups"
tags:
  - "CTF"
  - "Forensic"
  - "Windows"
  - "2025"
authors:
    - "harshfeudal"
---

## Äá» bÃ i

*obfuscated-1 (100pts)*

*Description*

*I installed every old software known to man... The flag is the VNC password, wrapped inÂ `ictf{}`.*

## HÆ°á»›ng giáº£i

Äá»ƒ mÃ  nÃ³i thÃ¬ bÃ i nÃ y mÃ¬nh khÃ´ng hiá»ƒu táº¡i sao nhiá»u ngÆ°á»i giáº£i Ä‘Æ°á»£c Ä‘áº¿n tháº¿ â€¦ táº¡i vÃ¬ kÄ© thuáº­t khÃ´ng Ä‘áº¿n ná»—i quÃ¡ dá»… Ä‘á»ƒ lÃ m ğŸ¤§

Sau khi mÃ¬nh unzip ra thÃ¬ mÃ¬nh tháº¥y Ä‘Ã¢y lÃ  má»™t folder chá»©a user cá»§a ngÆ°á»i dÃ¹ng trÃªn Win:

<div style="text-align: center;">
  <img src="image.png" alt="image.png" style="width: 80%; height: auto;" />
</div>

á» Ä‘Ã¢y, Ä‘iá»u Ä‘áº§u tiÃªn mÃ¬nh nÃªn lÃ m khi khÃ¡m phÃ¡ thá»© gÃ¬ Ä‘Ã³ chÃ­nh lÃ  khui tá»« file registry :D

Äá» cÃ³ cho file `NTUSER.DAT` thÃ¬ nhiá»‡m vá»¥ mÃ¬nh chá»‰ cáº§n viá»‡c `Win + R` vÃ  gÃµ `regedit` lÃ  xong:

<div style="text-align: center;">
  <img src="image%201.png" alt="image.png" style="width: 50%; height: auto;" />
</div>

Sau khi má»Ÿ Registry Editor rá»“i thÃ¬ náº¿u cÃ¡c báº¡n newbie vá» cÃ¡c dÃ¹ng nÃ y thÃ¬ mÃ¬nh hÆ°á»›ng dáº«n luÃ´n :D

CÃ¡c báº¡n áº¥n `HKEY_USERS` nÃ y:

<div style="text-align: center;">
  <img src="image%202.png" alt="image.png" style="width: 50%; height: auto;" />
</div>

Sau Ä‘Ã³ nhÃ¬n lÃªn má»¥c `File` > `Load Hive...` :

<div style="text-align: center;">
  <img src="image%203.png" alt="image.png" style="width: 50%; height: auto;" />
</div>

CÃ¡c báº¡n chá»n Ä‘Ãºng cÃ¡i file `NTUSER.DAT` cá»§a Ä‘á» cho nha (chá»n chÃ­nh file trÃªn mÃ¡y cá»§a máº¥y báº¡n thÃ¬ chá»‹u Ä‘áº¥y ğŸ§), vÃ  Ä‘áº·t tÃªn. á» Ä‘Ã¢y thÃ¬ mÃ¬nh sáº½ Ä‘áº·t tÃªn lÃ  `CTFHive` cho dá»… tÃ¬m:

<div style="text-align: center;">
  <img src="image%204.png" alt="image.png" style="width: 70%; height: auto;" />
</div>

Click `OK` lÃ  cÃ¡c báº¡n sáº½ tháº¥y trong danh má»¥c `HKEY_USERS` sáº½ cÃ³ cÃ¡i `CTFHive` :

<div style="text-align: center;">
  <img src="image%205.png" alt="image.png" style="width: 50%; height: auto;" />
</div>

Náº¿u cÃ¡c báº¡n cá»© thÃ­ch khÃ¡m phÃ¡ thÃ¬ cÃ¡c báº¡n cÃ³ thá»ƒ lá»¥c tung cÃ¡i folder Ä‘Ã³ cÅ©ng Ä‘Æ°á»£c :D

Do Ä‘á» cÃ³ mention pháº£i tÃ¬m VNC password nÃªn lÃ  mÃ¬nh sáº½ tÃ¬m Ä‘áº¿n gÃ¬ nÃ³ liÃªn quan Ä‘áº¿n Ä‘Ã³. ThÃ¬ sau má»™t há»“i lá»¥c tung cÃ¡i folder lÃªn thÃ¬ cÅ©ng tháº¥y Ä‘Æ°á»£c cÃ¡i má»¥c Ä‘Ã³ nÃ³ náº±m á»Ÿ `Software` :

<div style="text-align: center;">
  <img src="image%206.png" alt="image.png" style="width: 50%; height: auto;" />
</div>

áº¤n vÃ o má»¥c `TightVNC` sáº½ hiá»‡n thÃªm folder `Server` . Sau khi mÃ¬nh áº¥n tiáº¿p `Server` thÃ¬ nÃ³ sáº½ hiá»‡n ra nhÆ° sau:

<div style="text-align: center;">
  <img src="image%207.png" alt="image.png" style="width: 70%; height: auto;" />
</div>

KhÃ´ng khÃ³ Ä‘á»ƒ mÃ¬nh nháº­n ra á»Ÿ Ä‘Ã¢y cÃ³ cÃ¡i registry `Password` :

```
7e 9b 31 12 48 b7 c8 a8
```

Láº¥y Ä‘Æ°á»£c cÃ¡i nÃ y rá»“i thÃ¬ giáº£i mÃ£ Ä‘Ã¢y~

NhÆ°ng lÃ m sau Ä‘á»ƒ giáº£i nÃ³ ğŸ¥²

MÃ¬nh struggle chá»— nÃ y hÆ¡i lÃ¢u Ä‘áº¿n khi há»i Google vá» â€œVNC decryptâ€ thÃ¬ Ã´ng ná»™i nÃ y cÅ©ng cho mÃ¬nh tham kháº£o cÃ¡i repo nÃ y. Link dÆ°á»›i Ä‘Ã¢y:

[https://github.com/billchaison/VNCDecrypt](https://github.com/billchaison/VNCDecrypt)

Sau khi Ä‘á»c cÃ¢u nÃ y tá»« repo:

> *Assume the string from the .vnc file is `d7a514d8c556aade`*
> 
> *`echo -n d7a514d8c556aade | xxd -r -p | openssl enc -des-cbc --nopad --nosalt -K e84ad660c4721ae0 -iv 0000000000000000 -d -provider legacy -provider default | hexdump -Cv`*

thÃ¬ mÃ¬nh Ä‘Ã£ cÃ³ thÃªm clue Ä‘á»ƒ giáº£i. á» Ä‘Ã¢y cÃ¡c báº¡n cÃ³ thá»ƒ tháº¥y `e84ad660c4721ae0` lÃ  mÃ£ cá»‘ Ä‘á»‹nh, nghÄ©a lÃ  mÃ¬nh chá»‰ cáº§n biáº¿t má»™t dá»¯ kiá»‡n lÃ  ra.

MÃ¬nh Ä‘Ã£ nhá» ChatGPT viáº¿t há»™ mÃ¬nh (vibe-coding Ä‘i ae ğŸ§):

```python
from Crypto.Cipher import DES
import binascii

# your REG_BINARY value from regedit
blob_hex = "7e9b311248b7c8a8"

# TightVNC's fixed DES key
key = binascii.unhexlify("e84ad660c4721ae0")
blob = binascii.unhexlify(blob_hex)

dec = DES.new(key, DES.MODE_ECB).decrypt(blob)

print("Decrypted bytes:", dec)
print("Password:", dec.decode('latin1', errors='replace').strip())
```

Sau khi run xong thÃ¬ mÃ¬nh ra Ä‘Æ°á»£c:

```
Decrypted bytes: b'Slay4U!!'
Password: Slay4U!!
```

Äá» bÃ i kÃªu wrap flag sau khi Ä‘Ã£ tÃ¬m ra Ä‘Æ°á»£c password, tháº¿ thÃ¬ flag chÃ­nh lÃ :

```
ictf{Slay4U!!}
```

## Lá»i káº¿t

BÃ i nÃ y tháº¥y nhiá»u technique láº¯m mÃ  sao ai ai cÅ©ng solve ra dá»¯ váº­y :v

ÄÃ¡nh giÃ¡ bÃ i nÃ y: technique/10

(CÃ¡i hÃ¬nh khÃ´ng liÃªn quan nhÆ°ng thÃ´i ká»‡ cá»© Ä‘á»ƒ :D)

<img src="image%208.png" alt="image.png" style="width: 30%; height: auto;" />
