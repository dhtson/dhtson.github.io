---
title: "[Vi]: Web / Passwordless - Imaginary CTF 2025"
excerpt: "A writeup on the Web / Passwordless challenge from Imaginary CTF 2025"
category:
  - "CTF"
  - "Writeups"
tags:
  - "CTF"
  - "Web"
  - "2025"
languages:
    - vi
authors:
    - "harshfeudal"
---

*passwordless (100pts)*

*by Ciaran*

*Description*

*Didn't have time to implement the email sending feature but that's ok, the site is 100% secure if nobody knows their password to sign in!*

*http://passwordless.chal.imaginaryctf.org (link might expired)*

Okay thÃ¬ á»Ÿ thá»­ thÃ¡ch nÃ y khÃ¡ lÃ  thÃº vá»‹, lÃ  mÃ¬nh tÃ¬m cÃ¡ch Ä‘Äƒng nháº­p pass mÃ  khÃ´ng cáº§n biáº¿t máº­t kháº©u (Ä‘Ãºng nghÄ©a â€œPasswordlessâ€), do lÃ  tÃ­nh nÄƒng gá»­i email chá»©a máº­t kháº©u chÆ°a cÃ³ Ä‘Æ°á»£c setup. NÃ³i chung lá»—i nÃ y hÆ¡i phi thá»±c táº¿ xÃ­u, khÃ¡ lÃ  hiáº¿m gáº·p (cháº¯c máº¥y nhÃ³c má»›i há»c dev web chÆ°a há»c backend thÃ¬ may ra :D). Well nhÆ°ng mÃ  Ä‘á» cho thÃ¬ pháº£i giáº£i thoi~

BÃ i nÃ y cÃ³ cho file `index.js` Ä‘á»ƒ cÃ¡c báº¡n xem, nhÆ°ng do dÃ i quÃ¡ nÃªn mÃ¬nh khÃ´ng mention á»Ÿ Ä‘Ã¢y, cÃ³ thá»ƒ sau nÃ y mÃ¬nh sáº½ add attachments cho cÃ¡c báº¡n coi láº¡i challenge nÃ y (náº¿u mÃ¬nh cÃ³ free bá»™ nhá»›).

Okay thÃ¬ Ä‘Ã¢y lÃ  cÃ¡c yáº¿u tá»‘ mÃ¬nh tÃ¬m ra Ä‘Æ°á»£c:

- **Chuáº©n HÃ³a Email (Email Normalization):** web sá»­ dá»¥ng thÆ° viá»‡n `normalize-email` Ä‘á»ƒ chuáº©n hÃ³a Ä‘á»‹a chá»‰ email ngÆ°á»i dÃ¹ng cung cáº¥p. VÃ­ dá»¥ he, má»™t email nhÆ° `user.name+alias@gmail.com` sáº½ Ä‘Æ°á»£c chuáº©n hÃ³a thÃ nh `username@gmail.com`. Email nÃ y Ä‘Æ°á»£c dÃ¹ng lÃ m Ä‘á»‹nh danh duy nháº¥t cho ngÆ°á»i dÃ¹ng trong cÆ¡ sá»Ÿ dá»¯ liá»‡u.
- **Logic Táº¡o Máº­t Kháº©u:** Khi register, má»™t máº­t kháº©u táº¡m thá»i Ä‘Æ°á»£c táº¡o ra báº±ng cÃ¡ch ná»‘i **email gá»‘c (chÆ°a chuáº©n hÃ³a)** do ngÆ°á»i dÃ¹ng nháº­p vÃ o vá»›i má»™t chuá»—i ngáº«u nhiÃªn dÃ i 32 kÃ½ tá»± hexa. Máº­t kháº©u nÃ y sau Ä‘Ã³ Ä‘Æ°á»£c bÄƒm (hash) báº±ng `bcrypt` vÃ  lÆ°u vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u. Source á»Ÿ chá»— sao mÃ¬nh biáº¿t thÃ¬ bÃªn dÆ°á»›i Ä‘Ã¢y:

```jsx
const initialPassword = req.body.email + crypto.randomBytes(16).toString('hex')
```

â†’ Äiá»ƒm yáº¿u cá»§a thuáº­t toÃ¡n `bcrypt` lÃ  nÃ³ sáº½ cáº¯t ngáº¯n (truncate) máº­t kháº©u Ä‘áº§u vÃ o á»Ÿ Ä‘á»™ dÃ i 71 kÃ½ tá»±. Báº¥t ká»³ kÃ½ tá»± nÃ o sau kÃ½ tá»± thá»© 71 Ä‘á»u sáº½ bá»‹ bá» qua trong cáº£ quÃ¡ trÃ¬nh táº¡o hash vÃ  so sÃ¡nh máº­t kháº©u. NÃ³i tá»›i Ä‘Ã¢y lÃ  biáº¿t Ä‘Æ°á»£c sáº¯p lÃ m trÃ² con bÃ² gÃ¬ rÃ²i Ä‘Ã³ :D

Ye, chÃºng ta cÃ³ thá»ƒ register email ráº¥t dÃ i hÆ¡n 71 kÃ­ tá»±, vÃ  tá»± Ä‘á»™ng nÃ³ sáº½ chá»‰nh láº¡i thÃ nh má»™t email ngáº¯n gá»n hÆ¡n. Do máº­t kháº©u Ä‘Æ°á»£c táº¡o tá»« email gá»‘c siÃªu siÃªu dÃ i nÃ y, nÃªn lÃ  pháº§n phÃ­a sau cá»§a kÃ­ tá»± thá»© 71 Ä‘Ã³ sáº½ bá»‹ limit vÃ  bá»‹ `bcrypt` bá» qua, nÃªn lÃ  â€¦ biáº¿t rÃ²i Ä‘Ã³ ğŸ§

Tháº¿ thÃ¬ nhÃ o qua pháº§n Ä‘Äƒng kÃ­ tÃ i khoáº£n. á» má»¥c email thÃ¬ nháº­p:

```
exploit+bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb@gmail.com
```

Ye vÃ  tháº¿ gá»­i Ä‘i thoi~

![image.png](image.png)

Xong quay láº¡i bÆ°á»›c Ä‘Äƒng nháº­p:

- á» má»¥c Ä‘iá»n email thÃ¬ cÃ¡c báº¡n Ä‘iá»n: `exploit@gmail.com`
- á» má»¥c pass, cÃ¡c báº¡n nháº­p:

```
exploit+bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb@gmail.co
```

![image.png](image%201.png)

VÃ  tháº¿ lÃ  omedetou~

CÃ¡c báº¡n Ä‘Ã£ login :D

![image.png](image%202.png)

VÃ  flag lÃ :

```
ictf{8ee2ebc4085927c0dc85f07303354a05}
```

## Lá»i káº¿t

BÃ i oke, ez/10

<img src="image%203.png" alt="image.png" style="width: 30%; height: auto;" />
